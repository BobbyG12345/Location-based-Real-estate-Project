import proj4 from "proj4";

// 手动定义 EPSG:26910 (NAD83 / UTM zone 10N)
proj4.defs(
  "EPSG:26910",
  "+proj=utm +zone=10 +datum=NAD83 +units=m +no_defs +type=crs"
);

// 定义坐标系
const from = "EPSG:26910"; // NAD83 / UTM zone 10N
const to = "EPSG:4326"; // WGS84 (经纬度)

// 假设你的线段数据是 FeatureCollection<LineString>
const SurreyPre = [
  [510505.23599999957, 5451991.857437501],
  [511432.87768749986, 5451910.805062501],
  [514296.80262499955, 5451978.2383125],
  [514889.6144375, 5451593.270874999],
  [516105.61818750016, 5451294.8314375],
  [516654.50987500045, 5451211.50825],
  [518141.00293750037, 5451415.882875001],
  [518951.93900000025, 5451217.452125],
  [519582.64331249986, 5451009.668062501],
  [519928.9422500003, 5449921.489062501],
  [520004.54000000004, 5449197.9150625],
  [520204.0971250003, 5448452.148],
  [520370.21575000044, 5448240.501625],
  [520821.6481875004, 5447977.2442499995],
  [521307.8975625001, 5447836.0806249995],
  [521766.80206250027, 5447868.2276875],
  [522181.6796875, 5447936.381875001],
  [522429.8831249997, 5447984.546875],
  [522914.0968124997, 5448099.710750001],
  [523356.1838125, 5448302.328187501],
  [523356.3926250003, 5448182.8894375],
  [523359.5477499999, 5447180.008187501],
  [523376.1897499999, 5446420.151562501],
  [523394.05950000044, 5445613.724187501],
  [523385.0561250001, 5444807.3798124995],
  [523376.5379999997, 5443982.6694375],
  [523375.8540625004, 5443167.038000001],
  [523374.6434375001, 5442357.804375],
  [523367.9383749999, 5441548.885937501],
  [523362.08825000003, 5440742.3361875005],
  [523360.1782499999, 5439922.4233125],
  [523359.8333750004, 5439110.8745625],
  [523368.41837500036, 5438651.951312501],
  [523375.01662500016, 5438299.590187501],
  [523382.410375, 5437874.8323125],
  [523386.7036250001, 5437665.9683125],
  [523388.9468750004, 5437568.4836875],
  [523385.5853749998, 5437473.546500001],
  [523385.1356250001, 5437463.4464375],
  [523381.5479375003, 5437365.1348749995],
  [523377.87925000023, 5437263.466624999],
  [523374.19068749994, 5437161.786937499],
  [523370.6001249999, 5437061.003562501],
  [523367.26043749973, 5436851.863812501],
  [523360.0371249998, 5436634.842],
  [523354.82106249966, 5436462.125500001],
  [523348.8213750003, 5436239.553125],
  [523345.7859375002, 5436141.374875],
  [523332.42650000006, 5435809.2643125],
  [523334.22862500045, 5435474.730812501],
  [523326.4979999997, 5435463.803437499],
  [523327.48424999975, 5435210.066937501],
  [523328.2436250001, 5435018.6741875],
  [523328.2831875002, 5435006.7475000005],
  [523331.2823750004, 5434419.284500001],
  [523332.40443750005, 5434198.374625001],
  [523339.328125, 5434187.7698125],
  [523345.01625000034, 5433384.7594375],
  [523355.76768750045, 5432579.761500001],
  [523361.4656875003, 5432190.983562501],
  [523358.3373750001, 5431781.75725],
  [523365.41468750034, 5430971.7880625],
  [523365.5046875002, 5430961.728062501],
  [523383.8266874999, 5430165.020500001],
  [523408.14406250045, 5429349.140562501],
  [523400.1054375004, 5428536.6798125],
  [523394.50850000046, 5427741.186562501],
  [515337.1673750002, 5427706.7585],
  [515337.8891874999, 5429299.2621875],
  [515337.8696875004, 5429321.3249375],
  [515376.1403750004, 5429321.5095625],
  [516140.0779374996, 5429322.464749999],
  [516140.3063749997, 5430932.0635],
  [514533.7379999999, 5430933.789625],
  [512917.48762500007, 5430936.587187501],
  [511299.36624999996, 5430938.3899375],
  [511303.0253125001, 5427707.4739375],
  [503149.2234375002, 5427696.206375001],
  [503148.76856250037, 5428499.388250001],
  [508007.92093749996, 5434410.5236875005],
  [508003.19125000015, 5437653.9499375],
  [508002.9726250004, 5437735.6881875],
  [508001.6655000001, 5438387.169749999],
  [507999.77862500027, 5439100.946250001],
  [507994.9366250001, 5439894.5291875005],
  [507999.143375, 5440727.9286875],
  [507998.6013749996, 5441548.011187499],
  [507998.17512500007, 5442367.5213750005],
  [507997.1678750003, 5443171.9785625],
  [507995.59718750045, 5443978.793500001],
  [507993.37574999966, 5444802.382375],
  [507993.1593749998, 5445605.190874999],
  [507999.77825000044, 5446408.778875001],
  [508005.9018125003, 5447154.357249999],
  [507202.97331249993, 5447151.3780625],
  [506385.8463124996, 5447148.790312501],
  [506162.2279375, 5447147.5823125],
  [505624.01468749996, 5447144.3058125],
  [506235.37600000016, 5448798.717499999],
  [506433.2475624997, 5449218.473625001],
  [507324.60593749955, 5450049.6660625],
  [507603.24937499966, 5450356.7090625],
  [508438.87793750037, 5451655.9037500005],
  [508941.67512500007, 5451895.2594375],
  [509701.2011874998, 5452012.933125],
  [510505.23599999957, 5451991.857437501],
];

const SurreyConverted = SurreyPre.map((coord) => proj4(from, to, coord));

// 转换 [lng, lat] → [lat, lng]
// const Vancouver = VancouverPre.map((polygon) => [
//   polygon.map(([lng, lat]) => [lat, lng]),
// ]);

//去重
// const uniqueVancouver = Array.from(
//   new Map(VancouverPre.map((point) => [point.join(","), point])).values()
// );

// const coordinates = [...VancouverPre];

// 确保数组是闭合的
// if (
//   coordinates.length > 0 &&
//   (coordinates[0][0] !== coordinates[coordinates.length - 1][0] ||
//     coordinates[0][1] !== coordinates[coordinates.length - 1][1])
// ) {
//   coordinates.push(coordinates[0]);
// }

// 创建多边形
// const Vancouver = turf.polygon([coordinates]);

const Surrey = SurreyConverted.map(([lng, lat]) => [lat, lng]);

// console.log("VancouverCord", Vancouver);

// 也可以导出转换后的结果，方便其他文件直接用
export default Surrey;
